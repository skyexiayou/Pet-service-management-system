<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.xaut.mapper.AppointmentMapper">

    <select id="selectAppointmentsByUserId" resultType="cn.edu.xaut.domain.vo.appointment.AppointmentVO">
        SELECT
            a.ApptID as apptId,
            a.PetID as petId,
            p.PetName as petName,
            a.StoreID as storeId,
            s.StoreName as storeName,
            a.ApptTime as apptTime,
            a.ApptStatus as apptStatus,
            e.EmpName as empName,
            a.CreateTime as createTime
        FROM appointment a
        LEFT JOIN pet p ON a.PetID = p.PetID
        LEFT JOIN store s ON a.StoreID = s.StoreID
        LEFT JOIN employee e ON a.EmpID = e.EmpID
        WHERE a.UserID = #{userId}
        ORDER BY a.CreateTime DESC
    </select>

    <select id="selectAppointmentDetail" resultType="cn.edu.xaut.domain.vo.appointment.AppointmentDetailVO">
        SELECT
            a.ApptID as apptId,
            a.PetID as petId,
            p.PetName as petName,
            a.StoreID as storeId,
            s.StoreName as storeName,
            s.StoreAddress as storeAddress,
            s.StorePhone as storePhone,
            a.ApptTime as apptTime,
            a.ApptStatus as apptStatus,
            e.EmpName as empName,
            e.Position as empPosition,
            a.CreateTime as createTime
        FROM appointment a
        LEFT JOIN pet p ON a.PetID = p.PetID
        LEFT JOIN store s ON a.StoreID = s.StoreID
        LEFT JOIN employee e ON a.EmpID = e.EmpID
        WHERE a.ApptID = #{apptId}
    </select>

</mapper>
